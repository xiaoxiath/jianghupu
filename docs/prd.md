# 🧧 武侠 Roguelike AVG 游戏 PRD

---

## 一、产品概述

**产品名称**：江湖残卷（代号）
**类型**：开放世界文字冒险 / 武侠 Roguelike / AVG风格
**平台**：PC（CLI 或 Web 控制台）
**核心理念**：

> “江湖不止是舞台，而是一部活着的残卷。”

玩家在一个由AI叙事驱动的动态江湖中探索、修炼、结缘、成魔或陨落。每次开局世界皆不同，可无限演化与游玩。

---

## 二、核心体验目标

| 目标             | 说明                                 |
| -------------- | ---------------------------------- |
| 🗡️ 武侠氛围       | 古风文言叙事、江湖恩怨与宿命感。                   |
| 🔁 Roguelike特性 | 地图、功法、NPC、事件皆随机生成。                 |
| 💬 AVG式交互      | 命令输入与文字反馈（如 go, attack, meditate）。 |
| 🎭 AI说书人       | 以“说书叙事 + 随机选项”引导剧情分支。              |
| 🌏 开放世界        | 动态江湖生态，NPC与门派会演化、衰败或崛起。            |
| 🕰️ 无限游玩       | 代际传承系统，世界可自我延续。                    |

---

## 三、世界设定

**背景**：架空中原武林，正邪并立、群雄逐鹿。传闻“九天残卷”可令凡人成仙。
**风格关键词**：宿命、浪子、奇遇、传承、因果。

**地理结构（随机生成）**：

* 城镇：镖局、酒肆、客栈、书铺、赌坊
* 山野：盗匪营、秘洞、灵脉、兽林
* 门派：正道、邪宗、散修组织
* 奇境：遗迹、梦境、心魔幻境

---

## 四、核心系统模块

### 1️⃣ 玩家角色系统

| 模块       | 内容                     |
| -------- | ---------------------- |
| **属性**   | 力量、根骨、悟性、身法、气血、内力      |
| **境界层次** | 凡人 → 练气 → 真气 → 先天 → 宗师 |
| **功法系统** | 内功、外功、轻功、剑法、掌法、心法、暗器   |
| **性格取向** | 正 / 邪 / 中立，影响奇遇与门派态度   |
| **称号**   | 根据行为获得，如“行侠仗义”“血手人屠”   |
| **奇遇系统** | 触发独特事件或稀有功法            |

---

### 2️⃣ 战斗系统（回合制）

* 属性 + 武学技能影响命中、伤害、闪避。
* 内力运转系统（充能/气机流转）
* 心境波动影响表现（心魔、失误）
* 武学套路连击机制（组合触发特殊技）

---

### 3️⃣ 地图与探索系统

* 程序生成地图（seed-based）。
* 命令式探索：

  ```
  look
  go east
  investigate temple
  attack bandit
  ```

* 事件类型：战斗、机缘、社交、交易、陷阱。

---

## 五、AI 说书人系统（Narrative Bard）

> “说书人非旁观者，而是命运的低语者。”

### 功能目标

* 以叙事口吻讲述事件、营造氛围；
* 每节点给出3~5个选项；
* 不同选择推动剧情分支；
* AI根据玩家状态与世界变化实时改写剧情。

### 输出模板（示例）

> **说书人**：
> “长街风冷，烛火摇曳。你踏入镖局，只见血迹未干。”
>
> 选项：
> 1️⃣ 拔剑出门迎敌
> 2️⃣ 藏于暗处观望
> 3️⃣ 搜查尸体
> 4️⃣ 饮尽桌上残酒

玩家选择触发分支 → 世界与角色状态更新。

### 技术实现

* 本地或外部LLM生成叙事文本。
* 状态机控制剧情流转。
* 缓存AI输出，生成可复盘剧情。
* 说书人性格模板（宿命 / 诙谐 / 哲理 / 疯癫）。

---

## 六、开放世界与江湖生态系统

> “江湖有呼吸，众生有命运。”

### 世界分层结构

| 层级  | 内容          |
| --- | ----------- |
| 宏观层 | 地图、气候、朝代、时序 |
| 中观层 | 门派、朝廷、势力关系  |
| 微观层 | 城镇、野地、NPC活动 |
| 动态层 | 战争、叛变、奇遇、灾异 |

### NPC 生态

每个NPC拥有：

```
name, sect, alignment, reputation, martial_arts, ambition, location, relationships
```

NPC会主动修炼、结怨、叛门、死亡、成魔。
其行为影响门派与世界格局。

### 势力演化系统

* 门派关系矩阵：联盟 / 仇杀 / 中立。
* 定期触发门派大战、朝廷诏令、武林大会。
* 玩家暗杀掌门或传功皆可改写格局。

### 动态事件

* 持续刷新奇遇与灾变：

  * “西域风沙起，妖僧入中原。”
  * “江南水患，义军起于湖畔。”
* AI说书人总结事件，形成“活的江湖纪年”。

---

## 七、时间与演化机制

* 时间以“旬”为单位推进（约10天）。
* 玩家行动推进时间。
* 定期结算：

  * 势力关系更新
  * NPC命运演化
  * 物价波动
  * 资源再生或枯竭

---

## 八、无限游玩与传承系统

| 机制   | 说明                |
| ---- | ----------------- |
| 传承   | 死亡后可继承功法/名号/残卷碎片。 |
| 世代叙事 | 说书人讲述前代故事，形成江湖史。  |
| 动态复苏 | 秘境与奇遇每隔一段时间重新生成。  |
| 开放观察 | 可不再干预，仅观世界变化。     |

---

## 九、存档与优化

* 局部存档：仅存玩家所在区域及全局摘要。
* 世界快照：每十年生成一次“历史档案”。
* 渐进加载：仅在进入区域时加载详细状态。

---

## 十、技术架构概览

| 模块   | 技术方案                          |
| ---- | ----------------------------- |
| 游戏核心 | TypeScript / Python 引擎        |
| 界面层  | CLI（Node.js + chalk/inquirer） |
| 数据   | JSON/SQLite 存储状态              |
| 随机生成 | Seed-based RNG                |
| AI叙事 | 本地LLM（Ollama）或API调用           |
| 存档   | 本地文件系统                        |

---

## 十一、世界演化状态机（Mermaid）

```mermaid
stateDiagram-v2
    [*] --> 初始化
    初始化 --> 加载Mods
    加载Mods --> 运行Seeders
    运行Seeders --> 加载世界归档
    加载世界归档 --> 主循环

    主循环 --> 活态世界演化
    活态世界演化 --> 事件触发检查
    事件触发检查 --> AI说书人叙述
    AI说书人叙述 --> 获取玩家输入
    获取玩家输入 --> 主循环
    
    事件触发检查 -- 触发战斗 --> 战斗循环
    战斗循环 --> AI说书人叙述
    
    获取玩家输入 -- 输入exit --> [*]
```

---

## 十二、版本规划

| 阶段   | 内容              | 目标     |
| ---- | --------------- | ------ |
| V0.1 | 核心CLI + 战斗 + 探索 | 可玩Demo |
| V0.3 | 门派、奇遇、AI说书人     | 叙事循环   |
| V0.5 | 江湖生态 + NPC演化    | 开放世界雏形 |
| V0.8 | 传承系统 + 历史存档     | 无限游玩   |
| V1.0 | 内容扩展、文本润色       | 正式版发布  |

---

## 十三、扩展潜力

* 模块化剧情插件系统（MOD）
* 本地AI角色对话（LangChain整合）
* ASCII地图与地理天气系统
* Steam独立发行

---

> “江湖不灭，故事不止。每一次出剑，皆是新的一页。”
